import json
import random
import grapheme
import os

# --- Configuration ---
GRID_SIZE = 12
WORDS_PER_PUZZLE_MIN = 8
WORDS_PER_PUZZLE_MAX = 12

# --- Word Bank (100 Unique Themes) ---
# [The massive HINDI_PUZZLE_THEMES dictionary from the previous response goes here]
# ... I'm omitting it for brevity, but you should paste the full dictionary here.
HINDI_PUZZLE_THEMES = {
    "बॉलीवुड": [
        {"theme": "शाहरुख़ खान की फिल्में", "words": ["बाज़ीगर", "दिलवाले", "कुछकुछ", "स्वदेस", "पठान", "जवान", "चेन्नई", "वीरज़ारा", "कलहोनहो"]},
        {"theme": "सलमान खान की फिल्में", "words": ["बजरंगी", "सुल्तान", "दबंग", "टाइगर", "तेरेनाम", "अंतिम", "भारत", "मैंनेप्यारकिया"]},
        {"theme": "आमिर खान की फिल्में", "words": ["लगान", "दंगल", "तारेज़मीनपर", "गजनी", "रंगदेबसंती", "पीके", "सरफ़रोश", "अंदाज़अपनाअपना"]},
        {"theme": "अक्षय कुमार की फिल्में", "words": ["हेराफेरी", "खिलाड़ी", "पैडमैन", "टॉयलेट", "सूर्यवंशी", "एयरलिफ्ट", "केसरी", "मिशनमंगल"]},
        {"theme": "प्रसिद्ध निर्देशक", "words": ["राजकुमारहिरानी", "संजयलीलाभंसाली", "करणजौहर", "यशचोपड़ा", "अनुरागकश्यप", "ज़ोयाअख्तर", "सत्यजीतरे"]},
        {"theme": "महान गायक", "words": ["लतामंगेशकर", "किशोरकुमार", "मोहम्मद रफी", "आशाभोसले", "मुकेश", "मन्नाडे", "जगजीतसिंह"]},
        {"theme": "आधुनिक गायक", "words": ["अरिजीतसिंह", "श्रेयाघोषाल", "सोनूनिगम", "सुनिधिचौहान", "केके", "शान", "उदितनारायण", "कुमारसानू"]},
        {"theme": "संगीतकार", "words": ["एआररहमान", "प्रीतम", "विशालशेखर", "शंकरएहसानलॉय", "अमितत्रिवेदी", "आरडीबर्मन", "लक्ष्मीकांतप्यारेलाल"]},
        {"theme": "प्रसिद्ध अभिनेत्रियाँ (90s)", "words": ["माधुरी", "श्रीदेवी", "जूही", "काजोल", "करिश्मा", "रवीना", "मनीषा", "उर्मिला"]},
        {"theme": "प्रसिद्ध अभिनेत्रियाँ (Modern)", "words": ["दीपिका", "आलिया", "प्रियंका", "कंगना", "अनुष्का", "कटरीना", "करीना", "विद्याबालन"]},
        {"theme": "कॉमेडी फिल्में", "words": ["गोलमाल", "चुपचुपके", "धमाल", "जानेभीदोयारों", "अंदाज़अपनाअपना", "वेलकम", "हंगामा", "नोएंट्री"]},
        {"theme": "देशभक्ति फिल्में", "words": ["बॉर्डर", "उरी", "शेरशाह", "राज़ी", "चकदेइंडिया", "मंगलपांडे", "स्वदेस", "रंगदेबसंती"]},
        {"theme": "पुरस्कार विजेता फिल्में", "words": ["मदरइंडिया", "गाइड", "आनंद", "ब्लैक", "स्लमडॉग", "शिपऑफथिसियस", "न्यूटन", "गलीबॉय"]},
        {"theme": "ऐतिहासिक फिल्में", "words": ["मुग़लएआज़म", "जोधाअकबर", "बाजीरावमस्तानी", "पद्मावत", "तानाजी", "पानीपत", "मणिकर्णिका"]},
        {"theme": "प्रसिद्ध खलनायक", "words": ["अमजदखान", "अमरीशपुरी", "गुलशनग्रोवर", "शक्ति कपूर", "प्रेमचोपड़ा", "डैनी", "रंजीत"]},
        {"theme": "यश राज फिल्म्स", "words": ["डीडीएलजे", "सिलसिला", "कभीकभी", "डर", "चांदनी", "फना", "धूम", "बैंडबाजाबारात"]},
        {"theme": "धर्मा प्रोडक्शंस", "words": ["कभीख़ुशीकभीग़म", "मायनेमइज़ख़ान", "येजवानीहैदीवानी", "ऐदिलहैमुश्किल", "स्टूडेंट", "दोस्ताना"]},
        {"theme": "फिल्म पुरस्कार", "words": ["फिल्मफेयर", "राष्ट्रीयपुरस्कार", "आईफा", "स्टारडस्ट", "स्क्रीनअवार्ड्स", "दादासाहेबफाल्के"]},
        {"theme": "गीतकार", "words": ["गुलज़ार", "जावेदअख्तर", "प्रसूनजोशी", "इरशादकामिल", "अमिताभभट्टाचार्य", "समीर", "आनंदबख्शी"]},
        {"theme": "सिनेमा की शब्दावली", "words": ["ब्लॉकबस्टर", "पटकथा", "सिनेमैटोग्राफी", "कोरियोग्राफी", "संवाद", "बॉक्सऑफिस", "आइटमसांग"]},
        {"theme": "अमिताभ बच्चन की फिल्में", "words": ["शोले", "दीवार", "जंज़ीर", "अग्निपथ", "डॉन", "पा", "पिंक", "सरकार", "कभीख़ुशीकभीग़م"]},
        {"theme": "ऋतिक रोशन की फिल्में", "words": ["कहोनाप्यारहै", "कोईमिलगया", "कृष", "धूमटू", "अग्निपथ", "सुपरथर्टी", "वॉर", "जिंदगीनामिलेगीदोबारा"]},
        {"theme": "रणबीर कपूर की फिल्में", "words": ["बर्फी", "रॉकस्टार", "संजू", "वेकअपसिड", "राजनीति", "तमाशा", "एनिमल", "ब्रह्मास्त्र"]},
        {"theme": "विदेशी स्थानों पर शूट की गई फिल्में", "words": ["ज़िंदगीनामिलेगीदोबारा", "दिलवालेदुल्हनियालेजाएंगे", "तमाशा", "येजवानीहैदीवानी", "कलहोनहो", "डॉन"]},
        {"theme": "खेल पर आधारित फिल्में", "words": ["चकदेइंडिया", "लगान", "दंगल", "भागमिल्खाभाग", "मैरीकॉम", "पानसिंहतोमर", "इक़बाल", "सूरमा"]},
    ],
    "खेल": [
        {"theme": "क्रिकेट के दिग्गज", "words": ["सचिन", "विराट", "धोनी", "कपिलदेव", "गांगुली", "द्रविड़", "रोहित", "कुंबले", "सहवाग"]},
        {"theme": "क्रिकेट शब्दावली", "words": ["विकेट", "एलबीडब्ल्यू", "गुगली", "यॉर्कर", "चौका", "छक्का", "नोबॉल", "वाइड", "मेडेनओवर"]},
        {"theme": "आईपीएल टीमें", "words": ["मुंबई", "चेन्नई", "कोलकाता", "बैंगलोर", "दिल्ली", "पंजाब", "राजस्थान", "हैदराबाद", "लखनऊ", "गुजरात"]},
        {"theme": "विश्व कप विजेता कप्तान", "words": ["कपिलदेव", "इमरानखान", "अर्जुन रणतुंगा", "स्टीववॉ", "रिकीपोंटिंग", "धोनी", "माइकलक्लार्क", "इयोनमॉर्गन"]},
        {"theme": "हॉकी के जादूगर", "words": ["ध्यानचंद", "बलबीरसिंह", "धनराजपिल्लै", "रूपसिंह", "श्रीजेश", "मनप्रीत", "हरमनप्रीत"]},
        {"theme": "फुटबॉल के सितारे", "words": ["मेस्सी", "रोनाल्डो", "नेमार", "सुनीलछेत्री", "बाईचुंगभूटिया", "माराडोना", "पेले", "एमबाप्पे"]},
        {"theme": "ओलंपिक पदक विजेता (भारत)", "words": ["नीरजचोपड़ा", "पीवीसिंधु", "अभिनवबिंद्रा", "मैरीकॉम", "बजरंगपूनिया", "साक्षीमलिक", "मीराबाईचानू"]},
        {"theme": "टेनिस ग्रैंड स्लैम", "words": ["विंबलडन", "यूएसओपन", "फ्रेंचओपन", "ऑस्ट्रेलियनओपन", "ग्रैंड स्ललैम", "ड्यूस", "सर्विस", "ऐस"]},
        {"theme": "भारतीय महिला खिलाड़ी", "words": ["मितालीराज", "झूलनगोस्वामी", "सानियामिर्ज़ा", "साइनानेहवाल", "हिमादास", "विनेशफोगट", "हरमनप्रीत कौर"]},
        {"theme": "कबड्डी के महारथी", "words": ["अनूपकुमार", "प्रदीपनरवाल", "राहुलचौधरी", "अजयठाकुर", "दीपकनिवासहुड्डा", "पवनसहरावत"]},
        {"theme": "शतरंज के ग्रैंडमास्टर", "words": ["विश्वनाथनआनंद", "प्रज्ञानानंद", "गुकेश", "विदितगुजराती", "पेंटालाहरिकृष्णा", "अधिबन", "विदित"]},
        {"theme": "कुश्ती के पहलवान", "words": ["सुशीलकुमार", "योगेश्वरदत्त", "बजरंगपूनिया", "रवि कुमार दहिया", "साक्षीमलिक", "विनेशफोगट"]},
        {"theme": "प्रसिद्ध स्टेडियम", "words": ["वानखेड़े", "ईडनगार्डन्स", "चिन्नास्वामी", "फिरोजशाहकोटला", "नरेंद्रमोदी", "चेपॉक"]},
        {"theme": "खेल पुरस्कार", "words": ["खेल रत्न", "अर्जुनपुरस्कार", "द्रोणाचार्य", "ध्यानचंदपुरस्कार", "राजीवगांधी", "पद्मश्री"]},
        {"theme": "एशियाई खेल", "words": ["एशियाड", "स्वर्णपदक", "रजतपदक", "कांस्यपदक", "मशाल", "जकार्ता", "हांग्जो", "दोहा"]},
        {"theme": "राष्ट्रमंडल खेल", "words": ["कॉमनवेल्थ", "बर्मिंघम", "गोल्डकोस्ट", "ग्लासगो", "दिल्ली", "पदकतालिका", "क्वींसबैटन"]},
        {"theme": "बैडमिंटन के शब्द", "words": ["शटलकॉक", "रैकेट", "स्मैश", "ड्रॉपशॉट", "नेट", "सर्व", "कोर्ट", "मैचपॉइंट"]},
        {"theme": "तीरंदाजी", "words": ["धनुष", "तीर", "लक्ष्य", "बुल्सआई", "दीपिकाकुमारी", "अतनुदास", "लिंबाराम", "तरुणदीप"]},
        {"theme": "एथलेटिक्स", "words": ["दौड़", "भालाफेंक", "ऊंचीकूद", "लंबीकूद", "मैराथन", "स्प्रिंट", "रिले", "शॉटपुट", "डिस्कस"]},
        {"theme": "मुक्केबाजी", "words": ["नॉकआउट", "पंच", "रिंग", "ग्लव्स", "विजेंदरसिंह", "मैरीकॉम", "अमितपंघाल", "लवलीना"]},
        {"theme": "भारोत्तोलन", "words": ["वेटलिफ्टिंग", "स्नैच", "क्लीनएंडजर्क", "मीराबाईचानू", "कर्णममल्लेश्वरी", "जेरेमी"]},
        {"theme": "फॉर्मूला वन रेसिंग", "words": ["फेरारी", "मर्सिडीज", "रेडबुल", "मैक्लारेन", "पिटस्टॉप", "चेकर्डफ्लैग", "पोलपोजीशन", "हैमिल्टन"]},
        {"theme": "बास्केटबॉल", "words": ["डंक", "ड्रिबल", "हूप", "थ्रीपॉइंटर", "स्लैमडंक", "लेब्रोन", "जॉर्डन", "करी"]},
        {"theme": "गोल्फ", "words": ["होलइनवन", "बर्डी", "ईगल", "पार", "बंकर", "ग्रीन", "टाइगरवुड्स", "अनिर्बानलाहिड़ी"]},
        {"theme": "विभिन्न खेल", "words": ["वॉलीबॉल", "टेबलटेनिस", "स्क्वैश", "बिलियर्ड्स", "पोलो", "रग्बी", "बेसबॉल", "स्नूकर"]},
    ],
    "सामान्य ज्ञान": [
        {"theme": "भारत की नदियाँ", "words": ["गंगा", "यमुना", "ब्रह्मपुत्र", "गोदावरी", "कृष्णा", "नर्मदा", "कावेरी", "सिंधु", "महानदी", "ताप्ती"]},
        {"theme": "भारत के राज्य", "words": ["महाराष्ट्र", "उत्तरप्रदेश", "बिहार", "राजस्थान", "गुजरात", "कर्नाटक", "तमिलनाडु", "केरल", "पंजाब"]},
        {"theme": "राज्य और राजधानियाँ", "words": ["दिल्ली", "मुंबई", "कोलकाता", "चेन्नई", "लखनऊ", "पटना", "भोपाल", "जयपुर", "बेंगलुरु", "हैदराबाद"]},
        {"theme": "प्रसिद्ध स्मारक", "words": ["ताजमहल", "कुतुबमीनार", "इंडियागेट", "लालकिला", "हवामहल", "चारमीनार", "अजंता", "एलोरा", "कोणार्क"]},
        {"theme": "भारतीय त्योहार", "words": ["दिवाली", "होली", "दशहरा", "ईद", "क्रिसमस", "पोंगल", "ओणम", "बिहू", "दुर्गापूजा", "गणेशचतुर्थी"]},
        {"theme": "स्वतंत्रता सेनानी", "words": ["गांधी", "भगतसिंह", "सुभाषचंद्र", "पटेल", "नेहरू", "आज़ाद", "लक्ष्मीबाई", "मंगलपांडे", "सावरकर"]},
        {"theme": "सौर मंडल", "words": ["सूर्य", "बुध", "शुक्र", "पृथ्वी", "मंगल", "बृहस्पति", "शनि", "अरुण", "वरुण", "चंद्रमा"]},
        {"theme": "वैज्ञानिक और आविष्कार", "words": ["आर्यभट्ट", "सीवीरमन", "जगदीशचंद्रबोस", "होमीभाभा", "कलाम", "रामानुजन", "विक्रमसाराभाई"]},
        {"theme": "भारत के राष्ट्रपति", "words": ["राजेंद्रप्रसाद", "राधाकृष्णन", "जाकिरहुसैन", "वीवीगिरि", "फखरुद्दीन", "ज्ञानीजैलसिंह", "कलाम", "प्रणब"]},
        {"theme": "राष्ट्रीय प्रतीक", "words": ["तिरंगा", "अशोकचक्र", "जनगणमन", "वंदेमातरम", "सत्यमेवजयते", "बाघ", "मोर", "कमल", "आम"]},
        {"theme": "शास्त्रीय नृत्य", "words": ["भरतनाट्यम", "कथक", "कथकली", "कुचिपुड़ी", "ओडिसी", "मणिपुरी", "मोहिनीअट्टम", "सत्त्रिया"]},
        {"theme": "मुगल सम्राट", "words": ["बाबर", "हुमायूँ", "अकबर", "जहाँगीर", "शाहजहाँ", "औरंगज़ेब", "बहादुरशाह"]},
        {"theme": "पर्वत श्रृंखलाएं", "words": ["हिमालय", "अरावली", "विंध्य", "सतपुड़ा", "पश्चिमीघाट", "पूर्वीघाट", "काराकोरम", "नीलगिरि"]},
        {"theme": "पड़ोसी देश", "words": ["पाकिस्तान", "चीन", "नेपाल", "भूटान", "बांग्लादेश", "म्यांमार", "श्रीलंका", "मालदीव", "अफगानिस्तान"]},
        {"theme": "प्रमुख शहर", "words": ["पुणे", "अहमदाबाद", "सूरत", "नागपुर", "इंदौर", "कानपुर", "विशाखापत्तनम", "आगरा", "वाराणसी"]},
        {"theme": "भारतीय मुद्रा", "words": ["रुपया", "पैसा", "नोट", "सिक्का", "रिजर्वबैंक", "गांधी", "अशोकस्तंभ", "मंगलयान"]},
        {"theme": "सात अजूबे", "words": ["ताजमहल", "माचूपिच्चू", "चीचेनइट्ज़ा", "रोमनकोलोसियम", "क्राइस्टरिडीमर", "पेट्रा", "चीनकीदीवार"]},
        {"theme": "महाद्वीप", "words": ["एशिया", "अफ्रीका", "यूरोप", "ऑस्ट्रेलिया", "उत्तरीअमेरिका", "दक्षिणीअमेरिका", "अंटार्कटिका"]},
        {"theme": "महासागर", "words": ["प्रशांत", "अटलांटिक", "हिंद", "आर्कटिक", "अंटार्कटिक", "सागर", "महासागर"]},
        {"theme": "भारतीय मसाले", "words": ["हल्दी", "मिर्च", "धनिया", "जीरा", "इलायची", "लौंग", "दालचीनी", "कालीमिर्च", "तेजपत्ता"]},
        {"theme": "वाद्य यंत्र", "words": ["सितार", "तबला", "बांसुरी", "शहनाई", "संतूर", "सरोद", "वीणा", "हारमोनियम", "गिटार"]},
        {"theme": "शरीर के अंग", "words": ["हृदय", "मस्तिष्क", "फेफड़े", "यकृत", "गुर्दा", "आँख", "कान", "नाक", "पेट", "हड्डी"]},
        {"theme": "रंग", "words": ["लाल", "नीला", "पीला", "हरा", "गुलाबी", "नारंगी", "बैंगनी", "काला", "सफ़ेद", "भूरा"]},
        {"theme": "जानवर", "words": ["शेर", "बाघ", "हाथी", "घोड़ा", "बंदर", "जिराफ़", "भालू", "हिरण", "लोमड़ी", "ऊँट"]},
        {"theme": "फल", "words": ["आम", "केला", "सेब", "अनार", "संतरा", "अंगूर", "पपीता", "तरबूज", "अमरूद", "लीची"]},
    ],
    "राजनीति": [
        {"theme": "भारत के प्रधानमंत्री", "words": ["नेहरू", "इंदिरागांधी", "अटलबिहारी", "मनमोहनसिंह", "नरेंद्रमोदी", "शास्त्री", "राजीवगांधी", "मोरारजी", "वीपीसिंह"]},
        {"theme": "प्रमुख राजनीतिक दल", "words": ["भाजपा", "कांग्रेस", "समाजवादी", "आप", "तृणमूल", "शिवसेना", "डीएमके", "बहुजनसमाज", "एनसीपी", "सीपीआई"]},
        {"theme": "संसद के सदन", "words": ["संसद", "लोकसभा", "राज्यसभा", "सांसद", "अध्यक्ष", "विपक्ष", "सत्र", "विधेयक", "कानून"]},
        {"theme": "चुनाव प्रक्रिया", "words": ["चुनाव", "मतदान", "मतदाता", "बैलेट", "ईवीएम", "घोषणापत्र", "बहुमत", "गठबंधन", "अभियान", "परिणाम"]},
        {"theme": "ऐतिहासिक नेता", "words": ["गांधी", "अम्बेडकर", "पटेल", "सुभाषचंद्र", "भगतसिंह", "राजेंद्रप्रसाद", "जेपीनारायण", "लोहिया", "तिलक"]},
        {"theme": "संविधान की प्रस्तावना", "words": ["संविधान", "प्रस्तावना", "समाजवादी", "पंथनिरपेक्ष", "लोकतांत्रिक", "गणराज्य", "न्याय", "स्वतंत्रता", "समानता"]},
        {"theme": "मौलिक अधिकार", "words": ["अधिकार", "समानता", "स्वतंत्रता", "शोषण", "धार्मिक", "संवैधानिक", "शिक्षा", "जीवन"]},
        {"theme": "सरकारी संस्थाएं", "words": ["सुप्रीमकोर्ट", "चुनावआयोग", "नीतिआयोग", "रिजर्वबैंक", "सीबीआई", "यूपीएससी", "वित्तआयोग"]},
        {"theme": "प्रमुख मंत्रालय", "words": ["वित्त", "गृह", "रक्षा", "विदेश", "शिक्षा", "स्वास्थ्य", "रेल", "कृषि", "सड़कपरिवहन"]},
        {"theme": "राजनीतिक शब्दावली", "words": ["लोकतंत्र", "सरकार", "विपक्ष", "अध्यादेश", "महाभियोग", "अविश्वासप्रस्ताव", "व्हिप", "कोरम"]},
        {"theme": "भारत के राष्ट्रपति (चुनिंदा)", "words": ["राजेंद्रप्रसाद", "राधाकृष्णन", "कलाम", "प्रणबमुखर्जी", "रामनाथकोविंद", "द्रौपदीमुर्मू", "शंकरदयाल"]},
        {"theme": "राज्यों के मुख्यमंत्री", "words": ["योगीआदityanath", "ममताबनर्जी", "अरविंदकेजरीवाल", "नीतीशकुमार", "नवीनपटनायक", "एमकेस्टालिन"]},
        {"theme": "आपातकाल", "words": ["आपातकाल", "राष्ट्रपतिशासन", "वित्तीयआपात", "अनुच्छेद", "इंदिरागांधी", "आंतरिक", "बाहरी"]},
        {"theme": "पंचायती राज", "words": ["पंचायत", "ग्रामसभा", "सरपंच", "ब्लॉक", "जिलापरिषद", "स्थानीयस्वशासन", "विकेंद्रीकरण"]},
        {"theme": "अंतर्राष्ट्रीय संगठन", "words": ["संयुक्तराष्ट्र", "सार्क", "ब्रिक्स", "जीट्वेंटी", "विश्वबैंक", "आईएमएफ", "डब्ल्यूएचओ", "यूनेस्को"]},
        {"theme": "प्रमुख सरकारी योजनाएं", "words": ["मनरेगा", "जनधन", "स्वच्छभारत", "उज्ज्वला", "आयुष्मान", "स्किलइंडिया", "डिजिटलइंडिया", "मेकइनइंडिया"]},
        {"theme": "भारतीय दंड संहिता", "words": ["आईपीसी", "सीआरपीसी", "धारा", "अपराध", "सजा", "जमानत", "अदालत", "वकील", "सबूत"]},
        {"theme": "कर प्रणाली", "words": ["टैक्स", "जीएसटी", "आयकर", "सीमाशुल्क", "प्रत्यक्षकर", "अप्रत्यक्षकर", "स्लैब", "रिटर्न"]},
        {"theme": "भारत की विदेश नीति", "words": ["गुटनिरपेक्ष", "पंचशील", "पड़ोसीप्रथम", "लुकईस्ट", "एक्टईस्ट", "कूटनीति", "राजदूत"]},
        {"theme": "राजनीतिक विचारक (भारतीय)", "words": ["चाणक्य", "गांधी", "अम्बेडकर", "सावरकर", "नेहरू", "लोहिया", "दीनदयालउपाध्याय"]},
        {"theme": "संवैधानिक संशोधन", "words": ["संशोधन", "बयालीसवां", "चवालीसवां", "एकसौएक", "जीएसटी", "शिक्षाकाअधिकार", "प्रस्ताव"]},
        {"theme": "बजट प्रक्रिया", "words": ["बजट", "वित्तमंत्री", "राजकोषीयघाटा", "राजस्व", "व्यय", "विनियोगविधेयक", "आर्थिकसर्वेक्षण"]},
        {"theme": "संसदीय समितियां", "words": ["लोकलेखा", "प्राक्कलन", "सार्वजनिकउपक्रम", "स्थायीसमिति", "संयुक्तसमिति", "अध्यक्ष"]},
        {"theme": "भारत के झंडे का इतिहास", "words": ["तिरंगा", "केसरिया", "सफ़ेद", "हरा", "अशोकचक्र", "पिंगलीवेंकैया", "खादी", "ध्वजसंहिता"]},
        {"theme": "राज्यों का पुनठन", "words": ["राज्यपुनर्गठन", "भाषा", "आयोग", "आंध्रप्रदेश", "महाराष्ट्र", "गुजरात", "छत्तीसगढ़", "झारखंड", "उत्तराखंड"]},
    ]
}


HINDI_ALPHABET = list("अआइईउऊऋएऐओऔकखगघङचछजझञटठडढणतथदधनपफबभमयरलवशषसहक्षत्रज्ञ")

def split_hindi_word(word):
    return list(grapheme.graphemes(word))

def generate_puzzle(theme_name, word_list):
    # Function implementation from previous response...
    num_words_to_attempt = min(len(word_list), random.randint(WORDS_PER_PUZZLE_MIN, WORDS_PER_PUZZLE_MAX))
    words_to_place = random.sample(word_list, num_words_to_attempt)
    words_to_place.sort(key=lambda w: len(split_hindi_word(w)), reverse=True)
    grid = [['' for _ in range(GRID_SIZE)] for _ in range(GRID_SIZE)]
    word_locations = {}
    for word in words_to_place:
        placed = False
        graphemes = split_hindi_word(word)
        original_graphemes = list(graphemes)
        for _ in range(150):
            if placed: break
            direction = random.choice([(0, 1), (1, 0), (1, 1), (1, -1), (0, -1), (-1, 0), (-1, -1), (-1, 1)])
            graphemes = list(original_graphemes)
            if random.choice([True, False]): graphemes.reverse()
            word_len = len(graphemes)
            start_row, start_col = random.randint(0, GRID_SIZE - 1), random.randint(0, GRID_SIZE - 1)
            end_row, end_col = start_row + (word_len - 1) * direction[0], start_col + (word_len - 1) * direction[1]
            if 0 <= end_row < GRID_SIZE and 0 <= end_col < GRID_SIZE:
                can_place = True
                coords = []
                for i in range(word_len):
                    row, col = start_row + i * direction[0], start_col + i * direction[1]
                    coords.append({'r': row, 'c': col})
                    if grid[row][col] != '' and grid[row][col] != graphemes[i]:
                        can_place = False
                        break
                if can_place:
                    for i in range(word_len):
                        row, col = start_row + i * direction[0], start_col + i * direction[1]
                        grid[row][col] = graphemes[i]
                    word_locations[word] = coords
                    placed = True
    if len(word_locations) < len(words_to_place) * 0.7: return None
    for r in range(GRID_SIZE):
        for c in range(GRID_SIZE):
            if grid[r][c] == '': grid[r][c] = random.choice(HINDI_ALPHABET)
    return {"theme": theme_name, "words": list(word_locations.keys()), "grid": grid, "wordLocations": word_locations}

def main():
    all_puzzles = []
    print("Starting generation of 100 unique Hindi word search puzzles...")

    for main_category, sub_theme_list in HINDI_PUZZLE_THEMES.items():
        for theme_data in sub_theme_list:
            puzzle = None
            retries = 0
            while puzzle is None and retries < 10:
                puzzle = generate_puzzle(theme_data['theme'], theme_data['words'])
                retries += 1
            if puzzle:
                all_puzzles.append(puzzle)

    random.shuffle(all_puzzles)
    
    # --- CONFIGURED OUTPUT PATH ---
    output_dir = os.path.join('src', 'assets')
    os.makedirs(output_dir, exist_ok=True)
    output_path = os.path.join(output_dir, 'HindiWordSearch.json')

    with open(output_path, 'w', encoding='utf-8') as f:
        json.dump(all_puzzles, f, ensure_ascii=False, indent=2)
    
    print(f"\n✅ Success! Saved {len(all_puzzles)} unique puzzles to {output_path}")

if __name__ == "__main__":
    main()